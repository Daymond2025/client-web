name: Deploy Angular via FTP

on:
  push:
    branches:
      - master  # Change en 'master' si nÃ©cessaire

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Cloner le dÃ©pÃ´t
        uses: actions/checkout@v3

      - name: ğŸ”§ Installer Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18  # Change selon ta version Angular

      - name: ğŸ“¦ Installer les dÃ©pendances
        run: npm install

      - name: ğŸ”¨ Build du projet Angular
        run: npm run build -- --configuration=production

      - name: ğŸš€ DÃ©ployer via FTP
        uses: sebastianpopp/ftp-action@v1
        with:
          ftp-server: ${{ secrets.FTP_SERVER }}
          ftp-username: ${{ secrets.FTP_USERNAME }}
          ftp-password: ${{ secrets.FTP_PASSWORD }}
          local-dir: ./dist/daymond_client/browser/  # Remplace par le bon dossier
         # server-dir: "/sites/test.daymondboutique.com/"  # Remplace par ton dossier de production sur le serveur
          remote-dir: /sites/test.daymondboutique.com  # Le rÃ©pertoire distant de ton serveur

          # CrÃ©e un dossier de sauvegarde avec la date et dÃ©place les anciens fichiers
          remote-backup-dir: /sites/test.daymondboutique.com/backup/$(date +%Y-%m-%d_%H-%M-%S)  # Dossier de backup avec timestamp
          backup: true  # Utilise ce paramÃ¨tre pour dÃ©placer les fichiers dans un dossier de backup avant le dÃ©ploiement
